
[1] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON ossbr_2_1.SRSECCODE = ref.sm_SECURITY_CODE LEFT JOIN MFSPRIC ON SUBSTRING(GLSXREF.SEND_CD, 4, 5) = MFSPRIC.PRC_DTL_SEND_NUM


[2] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ON ossbr_2_1.SRSECCODE = GLSXREF.sm_SECURITY_CODE LEFT JOIN MFSPRIC ON SUBSTRING(GLSXREF.SEND_CD, 4, 5) = MFSPRIC.PRC_DTL_SEND_NUM


[3] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ON ossbr_2_1.SRSECCODE = GLSXREF.sm_SECURITY_CODE LEFT JOIN MFSPRIC ON SUBSTRING(GLSXREF.SEND_CD, 4, 5) = MFSPRIC.PRC_DTL_SEND_NUM


[4] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[5] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.WASTE_SECURITY_CODE


[6] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[7] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[8] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[9] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[10] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[11] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[12] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN tantrum tantrum ON mas.SRSECCODE = tantrum.SRSECCODE


[13] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN tantrum tantrum ON mas.SRSECCODE = tantrum.SRSECCODE


[14] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN tantrum tantrum ON mas.SRSECCODE = tantrum.SRSECCODE


[15] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[16] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[17] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[18] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSXREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE


[19] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE LEFT JOIN MFIN edx ON SUBSTRING (ref.SEND_CD, 4, 5) = edx.MFIN_SEND_NUMBER


[20] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE LEFT JOIN MFIN edx ON SUBSTRING (ref.SEND_CD, 4, 5) = edx.MFIN_SEND_NUMBER


[21] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE LEFT JOIN MFIN edx ON SUBSTRING (ref.SEND_CD, 4, 5) = edx.MFIN_SEND_NUMBER


[22] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
LEFT JOIN GLSREF ref ON mas.SRSECCODE = ref.sm_SECURITY_CODE LEFT JOIN MFIN edx ON SUBSTRING (ref.SEND_CD, 4, 5) = edx.MFIN_SEND_NUMBER


[23] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[24] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[25] ðŸ§© JOIN NORMALIZATION â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
nan


[26] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: asset_liblty_CD
Type: bigint
SQL: CAST(331 AS BIGINT)


[27] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: compnd_int_CD
Type: bigint
SQL: CAST(-2 AS BIGINT)


[28] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: curncy_CD
Type: bigint
SQL: CASE
   
    WHEN mas.SRCURRCODE IN ('BEF', 'DEM', 'FRF', 'GRD', 'TEP', 'ITL','NLG','PTE') 
      THEN '+00618' 
    ELSE CASE
   
    WHEN mas.secrty_curncy_id IN (-3,-4) 
      THEN '+00616' 
    ELSE COALESCE(get_stndrd_id('EDW','EDW_CURNCY_CD', 'N', mas.secrty_curncy_id), '+00616') 
  END 
  END AS CURNCY_CD


[29] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: cusip_id
Type: string
SQL: CASE
   
    WHEN RTRIM(mas.SRCUSIPNBR)=  
      THEN '000000000' 
    ELSE mas.SRCUSIPNBR 
  END AS CUSIP_ID


[30] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: erlcsh_eligbl_in
Type: string
SQL: CASE
   
    WHEN mas.SRSECTYPE = '210' 
      THEN 'N' 
    ELSE 'Y' 
  END AS ERLCSH_ELIGBL_IN


[31] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: final_offer_dt
Type: date
SQL: CAST(NULL AS DATE)


[32] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: first_offer_dt
Type: date
SQL: CASE
   
    WHEN TRY_CAST(mas.SBDSBDATE AS DATE) IS NOT NULL AND mas.SBDSBDATE <> '0001-01-01' 
      THEN mas.SBDSBDATE 
    ELSE NULL 
  END AS FIRST_OFFER_DT


[33] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: fis_paper_type_CD
Type: bigint
SQL: 'A'


[34] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: fis_secrty_id
Type: bigint
SQL: CAST(0 AS BIGINT)


[35] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: int_freq_CD
Type: bigint
SQL: CASE
   -- Check if tantrum_FAMLY_CD is +01309 (MMK) or +01310 (FIX) 
 
    WHEN tantrum.INSTR_FAMILY_CD IN ('+01309', '+01310') 
      THEN COALESCE(get_stndrd_id('EDW', 'EDW_INT_FREQ_CD', 'N', mas.SRPREQ),'-00001' -- Default to Not Applicable if no standard mapping is found 
 
    ELSE '-00001' -- Not Applicable 
 
  END AS INT_FREQ_CD


[36] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: int_rate_id
Type: bigint
SQL: CAST(0 AS BIGINT)


[37] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: int_relatn_CD
Type: bigint
SQL: CAST(-2 AS BIGINT)


[38] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: int_rt
Type: decimal
SQL: CASE
   
    WHEN TRY_CAST(mas.SRPMTRATE AS FLOAT) IS NOT NULL AND mas.SRPMTRATE > 0 AND mas.SRPMTRATE <= 999.99999 
      THEN mas.SRPMTRATE 
    ELSE NULL 
  END AS INT_RT


[39] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: issuer_org_id
Type: bigint
SQL: CAST(0 AS BIGINT)


[40] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: last_change_dt
Type: date
SQL: TO_DATE('"""${etl.effective.start.date}"""', 'yyyyMMddHHmmss')


[41] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: lifecy_CD
Type: bigint
SQL: CAST(114 AS BIGINT)


[42] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: load_ts
Type: timestamp
SQL: CURRENT_TIMESTAMP()


[43] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: mu_fund_family_CD
Type: bigint
SQL: CASE
   
    WHEN ref.sm_SECURITY_CODE IS NOT NULL AND LEFT(ref.SEND_CD, 3) = 'SBB' 
      THEN CASE
   
    WHEN edx.MFIN_SEND_NUMBER IS NOT NULL 
      THEN CASE
   
    WHEN edx.MFIN_ASSET_ORDER = 1 
      THEN '+08830' -- MMK /n 
    WHEN edx.MFIN_ASSET_ORDER = 2 
      THEN '+08831' -- PMMK /n 
    WHEN edx.MFIN_ASSET_ORDER = 3 
      THEN '+08832' -- ING /n 
    WHEN edx.MFIN_ASSET_ORDER = 4 
      THEN '+08833' -- BAL /n 
    WHEN edx.MFIN_ASSET_ORDER = 5 
      THEN '+08834' -- INX /n 
    WHEN edx.MFIN_ASSET_ORDER = 6 
      THEN '+08835' -- CDNEQ /n 
    WHEN edx.MFIN_ASSET_ORDER = 7 
      THEN '+08836' -- USEQ /n 
    WHEN edx.MFIN_ASSET_ORDER = 8 
      THEN '+08837' -- SEC /n 
    WHEN edx.MFIN_ASSET_ORDER = 9 
      THEN '+08838' -- GLO /n 
    WHEN edx.MFIN_ASSET_ORDER = 10 
      THEN '+08839' -- MAPM /n 
    WHEN edx.MFIN_ASSET_ORDER = 11 
      THEN '+08840' -- MAP /n 
    WHEN edx.MFIN_ASSET_ORDER - 12 
      THEN '+08841' -- MAP /n 
    WHEN edx.MFIN_ASSET_ORDER - 13 
      THEN '+08842' -- GIC /n 
    WHEN edx.MFIN_ASSET_ORDER = 14 
      THEN '+12553' -- COMFORT /n 
    WHEN edx.MFIN_ASSET_ORDER = 15 
      THEN '+12554' -- ADVANTAGE /n 
    WHEN edx.MFIN_ASSET_ORDER = 16 
      THEN '+12559' -- CORPORATE /n 
    ELSE '-00004' -- Invalid /n 
  END 
    ELSE '-00001' -- Not Applicable /n 
  END 
    ELSE '-00001' -- Not Applicable /n 
  END AS mu_fund_FAMILY_CD


[44] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: mu_fund_id
Type: string
SQL: CASE
   
    WHEN ref.sm_SECURITY_CODE IS NOT NULL 
      THEN ref.SEND_CD 
    ELSE '00000000' 
  END AS mu_fund_ID


[45] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: row_exclsn_dt
Type: date
SQL: CAST(NULL AS DATE)


[46] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: secrty_class_id
Type: bigint
SQL: CASE
   
    WHEN TRY_CAST(mas.SRSECCLAS AS INT) IS NOT NULL 
      THEN mas.SRSECCLAS 
    ELSE '0' 
  END AS SECRTY_CLASS_ID


[47] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: secrty_view_CD
Type: bigint
SQL: CAST(1342 AS BIGINT)


[48] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: sm_secrty_id
Type: string
SQL: TO_DATE({source_column}, 'YYYY-MM-DD')


[49] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: sm_secrty_type_id
Type: bigint
SQL: CASE
   
    WHEN TRY_CAST(mas.SRSECTYPE AS INT) IS NOT NULL 
      THEN mas.SRSECTYPE 
    ELSE '+00000' 
  END AS sm.SECRTY_TYPE_ID


[50] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: source_appl_CD
Type: bigint
SQL: CAST(239 AS BIGINT)


[51] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: sumary_combin_id
Type: string
SQL: CAST(NULL AS STRING)


[52] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: tantrum_family_CD
Type: bigint
SQL: CASE
   
    WHEN ref.sm_SECURITY_CODE IS NOT NULL 
      THEN CASE
   
    WHEN mas.SRSECTYPE IN ('380','331') 
      THEN '+01313' 
    ELSE '+01316' 
  END 
    ELSE CASE
   
    WHEN mas.SRSECTYPE = '220' 
      THEN '+01312' 
    WHEN mas.SRSECTYPE IN ('315','600','520','420','310','330','510') 
      THEN '+01314'  
    WHEN mas.SRSECTYPE IN ('551','553','555','559','567','550','556','557','570','581','554','558','568','569','573','562','530') 
      THEN '+01315' 
    WHEN mas.SRSECTYPE IN ('210','230','240') 
      THEN '+01309' 
    WHEN mas.SRSECTYPE IN ('263','265','275','260','261','270','262','276','290','295') 
      THEN '+01310' 
    ELSE '+01316'  
  END 
  END AS tantrum_family_cd


[53] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: tantrum_issued_in
Type: string
SQL: CASE
   
    WHEN ref.sm_SECURITY_CODE IS NOT NULL AND LEFT(ref.SEND_CD, 3) IN ('SBM', 'SBG', 'SBS','SBB', 'SBC') 
      THEN 'Y' 
    WHEN LEFT(mas.SRSHSBESE, 2) = 'SB' 
      THEN 'Y' 
    ELSE 'N' 
  END AS tantrum_issued_in


[54] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: tantrum_na
Type: string
SQL: CASE
   
    WHEN ref.sm_SECURITY_CODE IS NOT NULL 
      THEN RTRIM(ref.FUND_DESC) 
    ELSE RTRIM(mas.SRSHSBESE) 
  END AS tantrum_na


[55] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: tantrumid
Type: bigint
SQL: NULL /* unresolved expression guarded: CASE
  WHEN LEFT(GLSXREF.SEND_CD, 3) = 'SBB' THEN
    CASE
      WHEN SUBSTRING(GLSXREF.SEND_CD, 4, 5) = MFSPRIC.PRC_DTL... */
  END
  END


[56] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: tct_issue_in
Type: string
SQL: 'N'


[57] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: term_family_CD
Type: bigint
SQL: 'A'


[58] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: to_dt
Type: date
SQL: CAST('9999-12-31' AS DATE)


[59] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: trm_prodct_id
Type: bigint
SQL: CAST(0 AS BIGINT)


[60] ðŸ§© TRANSFORMATION FINAL â€” 2025-10-28 03:16:49
--------------------------------------------------------------------------------
Target: varble_rate_id
Type: bigint
SQL: CAST(0 AS BIGINT)

